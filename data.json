{"project":["eloAi","Home",[[[0,false,true,true,true,true,true,true,true,false,false,false,false,true,true,true,true,false,false,1,""],[2,false,true,true,true,false,false,true,false,false,true,false,false,true,false,false,true,true,false,1,""],[3,false,true,true,true,false,false,true,false,false,true,false,false,true,false,false,true,true,false,1,""],[4,false,true,true,true,true,true,true,true,false,false,false,false,true,true,false,true,false,false,1,""]],[[1,1,""]]],[["Loading_icons",0,false,[],1,0,null,[["Default",25,true,1,0,false,659513189021632,[["images/loading_icons-sheet0.webp",8508,1,1,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,93,1,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,185,1,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,277,1,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,385,1,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,1,93,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,93,93,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,185,93,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,277,93,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,385,93,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,1,185,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,93,185,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,185,185,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,277,185,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,385,185,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,1,277,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,93,277,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,185,277,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,277,277,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,385,277,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,1,385,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,93,385,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,185,385,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,277,385,90,90,false,1,0.5,0.5,[],[],""],["images/loading_icons-sheet0.webp",8508,385,385,90,90,false,1,0.5,0.5,[],[],""]]]],[["Якорь",1,250859230001367,0]],false,false,715428567263335,[],null,1,null],["Main",2,false,[],1,0,null,null,[["Якорь",1,463761313706967,0]],false,true,529978214815744,[],null,2,null],["Loading_HTML",3,false,[],0,0,null,null,[],false,false,625229888282866,[],null,3,null],["version_txt",4,false,[],1,0,null,null,[["Якорь",1,488913588930652,0]],false,false,833366881816129,[],null,4,null]],[],[["Loading",1080,1920,false,false,0.5,0.5,"Loading_System",530871035092905,[["Слой 0",0,525057555397913,true,[0,0,0],false,1,1,1,false,false,1,0,true,[[[0,0,0,1080,1920,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,["",""]],2,3,[],[],["div","<!DOCTYPE html> <html> <head>     <style>         body {             margin: 0;             background: #000;             display: flex;             justify-content: center;             align-items: center;             min-height: 100vh;         }         .loader {             display: flex;             gap: 4px;             height: 50px;             align-items: center;         }         .bar {             width: 6px;             height: 20px;             background: white;             animation: wave 1s ease-in-out infinite;         }         .bar:nth-child(1) { animation-delay: 0s; }         .bar:nth-child(2) { animation-delay: 0.1s; }         .bar:nth-child(3) { animation-delay: 0.2s; }         .bar:nth-child(4) { animation-delay: 0.3s; }         .bar:nth-child(5) { animation-delay: 0.4s; }         @keyframes wave {             0%, 100% { height: 10px; }             50% { height: 40px; }         }     </style> </head> <body>     <div class=\"loader\">         <div class=\"bar\"></div>         <div class=\"bar\"></div>         <div class=\"bar\"></div>         <div class=\"bar\"></div>         <div class=\"bar\"></div>     </div> </body> </html>",0,true,"","",false,0,0,true,[1,1,1],false,[1,1,1],true,false,""],""],[[797,1839,0,256,64,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,["",""]],3,4,[],[[2,2,1,1,true]],["v1.0",true,"monospace",25,0,false,false,[1,1,1],2,1,0,0,-1,true,0,false],""]],[],0,true,false,false,[]]],[],[]],["Home",1080,1920,false,false,0.5,0.5,"Home_System",342900725048561,[["Слой 0",0,401375994342414,true,[0,0,0],false,1,1,1,false,false,1,0,true,[[[0,0,0,1080,1920,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,["",""]],1,2,[],[[0,0,1,1,true]],["","<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>eloAi 1.0</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n        }\n        \n        :root {\n            --bg-primary: #000000;\n            --bg-secondary: #000000;\n            --bg-tertiary: #111111;\n            --text-primary: #ffffff;\n            --text-secondary: #888888;\n            --text-tertiary: #444444;\n            --border-color: #333333;\n            --border-active: #444444;\n            --accent-primary: #ffffff;\n            --accent-secondary: #cccccc;\n            --accent-green: #22c55e;\n            --accent-red: #ef4444;\n            --accent-yellow: #eab308;\n            --message-user-bg: #111111;\n            --message-ai-bg: transparent;\n            --input-bg: #0a0a0a;\n            --sidebar-bg: #000000;\n            --code-bg: #111111;\n            --code-border: #333333;\n            --shadow: 0 8px 24px rgba(0, 0, 0, 0.8);\n            --sidebar-width: 260px;\n            --input-radius: 24px;\n            --message-radius: 12px;\n        }\n        \n        body {\n            background-color: var(--bg-primary);\n            color: var(--text-primary);\n            line-height: 1.6;\n            min-height: 100vh;\n            display: flex;\n            overflow: hidden;\n            width: 100vw;\n            max-width: 100vw;\n        }\n        \n        /* Sidebar меню */\n        .sidebar {\n            width: var(--sidebar-width);\n            background-color: var(--sidebar-bg);\n            display: flex;\n            flex-direction: column;\n            height: 100vh;\n            position: fixed;\n            left: 0;\n            top: 0;\n            bottom: 0;\n            z-index: 1000;\n            overflow: hidden;\n            border-right: 1px solid var(--border-color);\n        }\n        \n        .sidebar-header {\n            padding: 20px;\n            flex-shrink: 0;\n            border-bottom: 1px solid var(--border-color);\n        }\n        \n        .new-chat-btn {\n            width: 100%;\n            padding: 14px 16px;\n            background-color: #ffffff;\n            color: #000000;\n            border: 1px solid #ffffff;\n            border-radius: 12px;\n            cursor: pointer;\n            font-size: 1rem;\n            font-weight: 600;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 10px;\n            transition: all 0.2s ease;\n        }\n        \n        .new-chat-btn:hover {\n            background-color: #cccccc;\n            border-color: #cccccc;\n        }\n        \n        .chats-list {\n            flex: 1;\n            overflow-y: auto;\n            padding: 20px;\n            min-height: 0;\n        }\n        \n        .chats-list::-webkit-scrollbar {\n            width: 6px;\n        }\n        \n        .chats-list::-webkit-scrollbar-track {\n            background: transparent;\n        }\n        \n        .chats-list::-webkit-scrollbar-thumb {\n            background: var(--border-color);\n            border-radius: 3px;\n        }\n        \n        .chats-list::-webkit-scrollbar-thumb:hover {\n            background: var(--text-tertiary);\n        }\n        \n        .chat-item {\n            padding: 16px;\n            margin-bottom: 10px;\n            background-color: #000000;\n            border-radius: 12px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            border: 1px solid var(--border-color);\n            color: #ffffff;\n        }\n        \n        .chat-item:hover {\n            background-color: #111111;\n            border-color: #444444;\n        }\n        \n        .chat-item.active {\n            background-color: #ffffff;\n            border-color: #ffffff;\n            color: #000000;\n        }\n        \n        .chat-item-content {\n            flex-grow: 1;\n            overflow: hidden;\n        }\n        \n        .chat-title {\n            font-weight: 600;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            font-size: 0.95rem;\n        }\n        \n        .chat-actions {\n            display: flex;\n            gap: 6px;\n            opacity: 0;\n            transition: opacity 0.2s;\n        }\n        \n        .chat-item:hover .chat-actions {\n            opacity: 1;\n        }\n        \n        .chat-action-btn {\n            background: none;\n            border: none;\n            cursor: pointer;\n            font-size: 0.9rem;\n            padding: 4px 6px;\n            border-radius: 6px;\n            transition: all 0.2s;\n        }\n        \n        .chat-item.active .chat-action-btn {\n            color: #000000;\n        }\n        \n        .chat-item:not(.active) .chat-action-btn {\n            color: #888888;\n        }\n        \n        .chat-action-btn:hover {\n            background-color: rgba(255, 255, 255, 0.1);\n        }\n        \n        .chat-item.active .chat-action-btn:hover {\n            background-color: rgba(0, 0, 0, 0.1);\n            color: #000000;\n        }\n        \n        .empty-chats {\n            text-align: center;\n            padding: 40px 20px;\n            color: var(--text-secondary);\n        }\n        \n        .empty-chats i {\n            font-size: 3rem;\n            margin-bottom: 20px;\n            opacity: 0.5;\n        }\n        \n        /* Основной контейнер */\n        .main-container {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n            width: calc(100vw - var(--sidebar-width));\n            height: 100vh;\n            position: fixed;\n            left: var(--sidebar-width);\n            right: 0;\n            top: 0;\n            bottom: 0;\n            max-width: calc(100vw - var(--sidebar-width));\n        }\n        \n        header {\n            padding: 16px 24px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            background-color: var(--bg-secondary);\n            flex-shrink: 0;\n            border-bottom: 1px solid var(--border-color);\n            position: relative;\n            z-index: 10;\n            width: 100%;\n            max-width: 100%;\n        }\n        \n        .header-left {\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n        \n        .header-title {\n            font-size: 1.2rem;\n            font-weight: normal;\n            color: var(--text-primary);\n            opacity: 0.8;\n        }\n        \n        .toggle-sidebar-btn {\n            background: none;\n            border: none;\n            font-size: 1.4rem;\n            color: var(--text-primary);\n            cursor: pointer;\n            padding: 8px;\n            border-radius: 8px;\n            transition: background-color 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            width: 40px;\n            height: 40px;\n            display: none;\n        }\n        \n        .toggle-sidebar-btn:hover {\n            background-color: var(--bg-tertiary);\n        }\n        \n        .header-right {\n            display: flex;\n            align-items: center;\n            gap: 20px;\n        }\n        \n        .status {\n            display: flex;\n            align-items: center;\n            gap: 10px;\n            font-size: 0.9rem;\n            padding: 8px 12px;\n            background-color: var(--bg-tertiary);\n            border-radius: 12px;\n        }\n        \n        .status-dot {\n            width: 10px;\n            height: 10px;\n            border-radius: 50%;\n            background-color: var(--text-tertiary);\n            position: relative;\n        }\n        \n        .status-dot.online {\n            background-color: var(--accent-green);\n            animation: pulse 2s infinite;\n        }\n        \n        .status-dot.offline {\n            background-color: var(--accent-red);\n        }\n        \n        .status-dot.checking {\n            background-color: var(--accent-yellow);\n        }\n        \n        @keyframes pulse {\n            0% { opacity: 1; }\n            50% { opacity: 0.5; }\n            100% { opacity: 1; }\n        }\n        \n        .chat-container {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            background-color: var(--bg-primary);\n            overflow: hidden;\n            position: relative;\n            width: 100%;\n            max-width: 100%;\n        }\n        \n        /* Прокрутка чата */\n        .messages-container {\n            flex: 1;\n            padding: 24px;\n            overflow-y: auto;\n            display: flex;\n            flex-direction: column;\n            gap: 20px;\n            min-height: 0;\n            width: 100%;\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        /* Разрешаем прокрутку даже при печати */\n        .messages-container.typing-active {\n            overflow-y: auto !important;\n            pointer-events: auto !important;\n        }\n        \n        .messages-container::-webkit-scrollbar {\n            width: 8px;\n        }\n        \n        .messages-container::-webkit-scrollbar-track {\n            background: var(--bg-primary);\n            border-radius: 4px;\n        }\n        \n        .messages-container::-webkit-scrollbar-thumb {\n            background: var(--border-color);\n            border-radius: 4px;\n        }\n        \n        .messages-container::-webkit-scrollbar-thumb:hover {\n            background: var(--text-tertiary);\n        }\n        \n        .message {\n            display: flex;\n            max-width: 90%;\n            animation: fadeIn 0.3s ease-out;\n            word-wrap: break-word;\n            overflow-wrap: break-word;\n            position: relative;\n            width: 100%;\n        }\n        \n        @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(10px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n        \n        .message.user {\n            align-self: flex-end;\n            max-width: 90%;\n        }\n        \n        .message.assistant {\n            align-self: flex-start;\n            max-width: 90%;\n        }\n        \n        .message-content {\n            padding: 16px 20px;\n            border-radius: var(--message-radius);\n            line-height: 1.6;\n            max-width: 100%;\n            word-wrap: break-word;\n            overflow-wrap: break-word;\n            position: relative;\n            width: 100%;\n            box-sizing: border-box;\n        }\n        \n        .user .message-content {\n            background-color: var(--message-user-bg);\n            color: var(--text-primary);\n            border: 1px solid var(--border-color);\n            padding-right: 50px;\n            max-width: 100%;\n        }\n        \n        .assistant .message-content {\n            background-color: var(--message-ai-bg);\n            color: var(--text-primary);\n            padding-left: 0;\n            padding-right: 50px;\n            max-width: 100%;\n        }\n        \n        .message-text {\n            word-wrap: break-word;\n            overflow-wrap: break-word;\n            white-space: pre-wrap;\n            max-width: 100%;\n            font-size: 15px;\n            width: 100%;\n            box-sizing: border-box;\n        }\n        \n        /* Элемент \"ИИ думает\" */\n        .thinking-indicator {\n            align-self: flex-start;\n            max-width: 90%;\n            margin: 10px 0;\n            width: 100%;\n        }\n        \n        .thinking-content {\n            padding: 16px 20px;\n            border-radius: var(--message-radius);\n            background-color: transparent;\n            color: var(--text-secondary);\n            font-style: italic;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            animation: fadeIn 0.3s ease-out;\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        .thinking-dots {\n            display: flex;\n            gap: 4px;\n        }\n        \n        .thinking-dot {\n            width: 8px;\n            height: 8px;\n            border-radius: 50%;\n            background-color: var(--text-secondary);\n            animation: thinkingPulse 1.5s infinite ease-in-out;\n        }\n        \n        .thinking-dot:nth-child(1) {\n            animation-delay: 0s;\n        }\n        \n        .thinking-dot:nth-child(2) {\n            animation-delay: 0.2s;\n        }\n        \n        .thinking-dot:nth-child(3) {\n            animation-delay: 0.4s;\n        }\n        \n        @keyframes thinkingPulse {\n            0%, 60%, 100% {\n                opacity: 0.3;\n                transform: scale(0.8);\n            }\n            30% {\n                opacity: 1;\n                transform: scale(1);\n            }\n        }\n        \n        /* Кнопка копирования сообщения */\n        .copy-message-btn {\n            position: absolute;\n            right: 10px;\n            top: 10px;\n            background: none;\n            border: none;\n            color: var(--text-secondary);\n            cursor: pointer;\n            font-size: 14px;\n            padding: 6px;\n            border-radius: 6px;\n            opacity: 0;\n            transition: all 0.2s;\n            z-index: 2;\n        }\n        \n        .message-content:hover .copy-message-btn {\n            opacity: 1;\n        }\n        \n        .copy-message-btn:hover {\n            background-color: rgba(255, 255, 255, 0.1);\n            color: var(--text-primary);\n        }\n        \n        /* Стили для блока кода */\n        .code-block {\n            position: relative;\n            background-color: var(--code-bg);\n            border: 1px solid #555555;\n            border-radius: 8px;\n            margin: 16px 0;\n            overflow: hidden;\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        .code-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 12px;\n            background-color: var(--bg-tertiary);\n            border-bottom: 1px solid #555555;\n            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;\n            font-size: 13px;\n            color: var(--text-secondary);\n            max-width: 100%;\n            overflow: hidden;\n        }\n        \n        .code-language {\n            font-weight: 600;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            max-width: 50%;\n        }\n        \n        .copy-code-btn {\n            background: none;\n            border: none;\n            color: var(--text-secondary);\n            cursor: pointer;\n            font-size: 14px;\n            padding: 4px 8px;\n            border-radius: 4px;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            white-space: nowrap;\n        }\n        \n        .copy-code-btn:hover {\n            background-color: rgba(255, 255, 255, 0.1);\n            color: var(--text-primary);\n        }\n        \n        .copy-code-btn.copied {\n            color: var(--accent-green);\n        }\n        \n        .code-content {\n            padding: 16px;\n            overflow-x: auto;\n            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;\n            font-size: 14px;\n            line-height: 1.5;\n            color: var(--text-primary);\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        .message-text code:not(pre code) {\n            background-color: var(--code-bg);\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;\n            font-size: 14px;\n            border: 1px solid #555555;\n            word-break: break-all;\n        }\n        \n        .message-text ul, \n        .message-text ol {\n            padding-left: 24px;\n            margin: 12px 0;\n            max-width: 100%;\n            overflow: hidden;\n        }\n        \n        .message-text li {\n            margin-bottom: 6px;\n            word-break: break-word;\n        }\n        \n        /* Поле ввода */\n        .input-container {\n            padding: 20px 24px;\n            background-color: var(--bg-secondary);\n            position: sticky;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            z-index: 100;\n            border-top: 1px solid var(--border-color);\n            width: 100%;\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        .input-wrapper {\n            position: relative;\n            border-radius: var(--input-radius);\n            background-color: var(--input-bg);\n            border: 1px solid var(--border-color);\n            transition: all 0.3s ease;\n            padding: 4px;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n            width: 100%;\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        .input-wrapper:focus-within {\n            border-color: var(--border-active);\n            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1);\n        }\n        \n        textarea {\n            width: 100%;\n            padding: 16px 20px;\n            padding-right: 140px;\n            border: none;\n            font-size: 15px;\n            resize: none;\n            outline: none;\n            background: transparent;\n            color: var(--text-primary);\n            line-height: 1.5;\n            font-family: inherit;\n            word-wrap: break-word;\n            overflow-wrap: break-word;\n            min-height: 24px;\n            max-height: 200px;\n            box-sizing: border-box;\n            max-width: 100%;\n        }\n        \n        textarea::placeholder {\n            color: var(--text-tertiary);\n        }\n        \n        .input-actions {\n            position: absolute;\n            right: 12px;\n            top: 50%;\n            transform: translateY(-50%);\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n        \n        .file-upload-btn {\n            background: none;\n            border: none;\n            color: var(--text-secondary);\n            cursor: pointer;\n            font-size: 1.2rem;\n            padding: 8px;\n            border-radius: 50%;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .file-upload-btn:hover {\n            background-color: var(--bg-tertiary);\n            color: var(--text-primary);\n        }\n        \n        .send-button {\n            background-color: var(--text-primary);\n            color: var(--bg-primary);\n            border: none;\n            border-radius: 50%;\n            width: 40px;\n            height: 40px;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 1.1rem;\n            transition: all 0.2s ease;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);\n        }\n        \n        .send-button:hover {\n            background-color: var(--accent-secondary);\n            transform: scale(1.05);\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\n        }\n        \n        .send-button:active {\n            transform: scale(0.95);\n        }\n        \n        .send-button:disabled {\n            background-color: var(--text-tertiary);\n            cursor: not-allowed;\n            transform: none;\n        }\n        \n        .send-button.stop-typing {\n            background-color: var(--accent-red);\n        }\n        \n        .send-button.stop-typing:hover {\n            background-color: #dc2626;\n        }\n        \n        .send-button i {\n            transform: rotate(90deg);\n        }\n        \n        .send-button.stop-typing i {\n            transform: none;\n        }\n        \n        /* Загруженные файлы */\n        .uploaded-files {\n            display: flex;\n            gap: 10px;\n            margin-top: 12px;\n            flex-wrap: wrap;\n            max-width: 100%;\n        }\n        \n        .uploaded-file {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            padding: 8px 12px;\n            background-color: var(--bg-tertiary);\n            border-radius: 12px;\n            font-size: 0.9rem;\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        .file-icon {\n            color: var(--accent-secondary);\n        }\n        \n        .file-name {\n            color: var(--text-primary);\n            max-width: 150px;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n        }\n        \n        .file-remove {\n            background: none;\n            border: none;\n            color: var(--text-secondary);\n            cursor: pointer;\n            padding: 2px;\n            border-radius: 4px;\n        }\n        \n        .file-remove:hover {\n            color: var(--accent-red);\n            background-color: rgba(255, 255, 255, 0.1);\n        }\n        \n        .image-preview {\n            max-width: 100%;\n            max-height: 300px;\n            border-radius: 12px;\n            margin-top: 10px;\n            object-fit: cover;\n            border: 1px solid var(--border-color);\n            box-sizing: border-box;\n        }\n        \n        /* Анимация текста по буквам */\n        .typing-text {\n            display: inline-block;\n            overflow: hidden;\n            border-right: 2px solid var(--text-secondary);\n            white-space: pre-wrap;\n            animation: typingCursor 0.75s step-end infinite;\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        @keyframes typingCursor {\n            0%, 100% { border-color: transparent; }\n            50% { border-color: var(--text-secondary); }\n        }\n        \n        .error-message {\n            background-color: rgba(239, 68, 68, 0.1);\n            color: var(--accent-red);\n            padding: 12px 16px;\n            border-radius: 12px;\n            margin: 10px 0;\n            font-size: 0.9rem;\n            max-width: 100%;\n            word-break: break-word;\n            box-sizing: border-box;\n        }\n        \n        .empty-chat {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            height: 100%;\n            color: var(--text-secondary);\n            padding: 60px;\n            text-align: center;\n            flex: 1;\n            width: 100%;\n            max-width: 100%;\n            box-sizing: border-box;\n        }\n        \n        .empty-chat i {\n            font-size: 5rem;\n            margin-bottom: 24px;\n            opacity: 0.5;\n            color: var(--text-tertiary);\n        }\n        \n        .empty-chat h3 {\n            font-size: 1.8rem;\n            margin-bottom: 16px;\n            color: var(--text-primary);\n            font-weight: 600;\n        }\n        \n        .empty-chat p {\n            max-width: 600px;\n            line-height: 1.6;\n            color: var(--text-secondary);\n            width: 100%;\n        }\n        \n        .sidebar-overlay {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background-color: rgba(0,0,0,0.8);\n            z-index: 999;\n            backdrop-filter: blur(4px);\n        }\n        \n        /* Мобильная адаптация */\n        @media (max-width: 768px) {\n            body {\n                overflow-x: hidden;\n            }\n            \n            .sidebar {\n                transform: translateX(-100%);\n                width: 85%;\n                max-width: 320px;\n                transition: transform 0.3s ease;\n                z-index: 1000;\n            }\n            \n            .sidebar.active {\n                transform: translateX(0);\n            }\n            \n            .main-container {\n                margin-left: 0;\n                left: 0;\n                width: 100vw;\n                max-width: 100vw;\n            }\n            \n            .messages-container {\n                padding: 16px;\n                max-width: 100vw;\n            }\n            \n            .message {\n                max-width: 95%;\n            }\n            \n            .message.user,\n            .message.assistant {\n                max-width: 95%;\n            }\n            \n            .thinking-indicator {\n                max-width: 95%;\n            }\n            \n            .input-container {\n                padding: 16px;\n                max-width: 100vw;\n            }\n            \n            .status {\n                display: none;\n            }\n            \n            .toggle-sidebar-btn {\n                display: flex;\n            }\n            \n            .image-preview {\n                max-width: 100%;\n                max-height: 250px;\n            }\n            \n            textarea {\n                padding-right: 120px;\n                max-width: calc(100vw - 32px);\n            }\n            \n            .sidebar-overlay.active {\n                display: block;\n            }\n            \n            .empty-chat {\n                padding: 40px 20px;\n                max-width: 100vw;\n            }\n            \n            .empty-chat i {\n                font-size: 4rem;\n            }\n            \n            .empty-chat h3 {\n                font-size: 1.5rem;\n            }\n        }\n        \n        /* Стилизация скроллбара */\n        ::-webkit-scrollbar {\n            width: 8px;\n            height: 8px;\n        }\n        \n        ::-webkit-scrollbar-track {\n            background: var(--bg-secondary);\n            border-radius: 4px;\n        }\n        \n        ::-webkit-scrollbar-thumb {\n            background: var(--border-color);\n            border-radius: 4px;\n        }\n        \n        ::-webkit-scrollbar-thumb:hover {\n            background: var(--text-tertiary);\n        }\n    </style>\n</head>\n<body>\n    <!-- Overlay для мобильного меню -->\n    <div class=\"sidebar-overlay\" id=\"sidebarOverlay\"></div>\n    \n    <!-- Sidebar меню -->\n    <div class=\"sidebar\" id=\"sidebar\">\n        <div class=\"sidebar-header\">\n            <button class=\"new-chat-btn\" id=\"newChatBtn\">\n                <i class=\"fas fa-plus\"></i> Новый чат\n            </button>\n        </div>\n        \n        <div class=\"chats-list\" id=\"chatsList\">\n            <!-- Список чатов будет загружен здесь -->\n            <div class=\"empty-chats\" id=\"emptyChatsMessage\">\n                <i class=\"fas fa-comments\"></i>\n                <p>У вас пока нет сохраненных чатов</p>\n                <p style=\"font-size: 0.9rem; margin-top: 10px;\">Создайте новый чат, чтобы начать общение</p>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Основной контейнер -->\n    <div class=\"main-container\" id=\"mainContainer\">\n        <header>\n            <div class=\"header-left\">\n                <button class=\"toggle-sidebar-btn\" id=\"toggleSidebarBtn\" title=\"Скрыть/показать панель\">\n                    <i class=\"fas fa-bars\" id=\"toggleIcon\"></i>\n                </button>\n                <div class=\"header-title\">eloAi 1.0</div>\n            </div>\n            <div class=\"header-right\">\n                <div class=\"status\" id=\"status\">\n                    <span class=\"status-dot checking\" id=\"statusDot\"></span>\n                    <span class=\"status-text\" id=\"statusText\">Проверка...</span>\n                </div>\n            </div>\n        </header>\n        \n        <div class=\"chat-container\">\n            <!-- Сообщения -->\n            <div class=\"messages-container\" id=\"messagesContainer\">\n                <!-- Пустое состояние чата -->\n                <div class=\"empty-chat\" id=\"emptyChatMessage\">\n                    <i class=\"fas fa-robot\"></i>\n                    <h3>Добро пожаловать в eloAi 1.0!</h3>\n                    <p>Начните новый разговор, задав вопрос.</p>\n                    <p style=\"margin-top: 20px; font-size: 0.9rem; color: var(--text-tertiary);\">\n                        eloAi поможет вам с программированием, анализом данных и другими задачами.\n                    </p>\n                </div>\n                \n                <!-- Сообщения будут добавляться здесь -->\n            </div>\n            \n            <!-- Поле ввода -->\n            <div class=\"input-container\">\n                <!-- Контейнер для загруженных файлов -->\n                <div class=\"uploaded-files\" id=\"uploadedFilesContainer\"></div>\n                \n                <!-- Обертка для поля ввода -->\n                <div class=\"input-wrapper\">\n                    <textarea id=\"messageInput\" placeholder=\"Введите ваше сообщение...\" rows=\"1\"></textarea>\n                    <div class=\"input-actions\">\n                        <label for=\"fileUpload\" class=\"file-upload-btn\" title=\"Прикрепить изображение\">\n                            <i class=\"fas fa-paperclip\"></i>\n                        </label>\n                        <input type=\"file\" id=\"fileUpload\" accept=\"image/*\" style=\"display: none;\">\n                        <button class=\"send-button\" id=\"sendButton\" title=\"Отправить сообщение\">\n                            <i class=\"fas fa-arrow-up\" id=\"sendIcon\"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <script>\n        // API ключ\n        const API_KEY = \"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\";\n        const API_URL = \"https://openrouter.ai/api/v1/chat/completions\";\n        \n        // Элементы DOM\n        const sidebar = document.getElementById('sidebar');\n        const sidebarOverlay = document.getElementById('sidebarOverlay');\n        const toggleSidebarBtn = document.getElementById('toggleSidebarBtn');\n        const toggleIcon = document.getElementById('toggleIcon');\n        const mainContainer = document.getElementById('mainContainer');\n        const newChatBtn = document.getElementById('newChatBtn');\n        const chatsList = document.getElementById('chatsList');\n        const emptyChatsMessage = document.getElementById('emptyChatsMessage');\n        const messagesContainer = document.getElementById('messagesContainer');\n        const emptyChatMessage = document.getElementById('emptyChatMessage');\n        const messageInput = document.getElementById('messageInput');\n        const sendButton = document.getElementById('sendButton');\n        const sendIcon = document.getElementById('sendIcon');\n        const status = document.getElementById('status');\n        const statusDot = document.getElementById('statusDot');\n        const statusText = document.getElementById('statusText');\n        const fileUpload = document.getElementById('fileUpload');\n        const uploadedFilesContainer = document.getElementById('uploadedFilesContainer');\n        \n        // Хранилище чатов и файлов\n        let chats = {};\n        let currentChatId = null;\n        let chatCounter = 1;\n        let uploadedFiles = [];\n        let isTyping = false;\n        let typingTimeout = null;\n        let currentTypingElement = null;\n        let typingSpeed = 20;\n        let typingIndex = 0;\n        let fullText = '';\n        let thinkingIndicator = null;\n        \n        // Проверка подключения при загрузке\n        document.addEventListener('DOMContentLoaded', () => {\n            loadChatsFromStorage();\n            checkAPIConnection();\n            setupEventListeners();\n            messageInput.focus();\n            \n            // Инициализируем высоту textarea\n            autoResizeTextarea.call(messageInput);\n            \n            // Принудительно устанавливаем правильные размеры\n            setTimeout(adjustLayout, 100);\n        });\n        \n        // Функция для корректировки макета\n        function adjustLayout() {\n            const sidebarWidth = sidebar.offsetWidth;\n            const windowWidth = window.innerWidth;\n            \n            if (windowWidth > 768) {\n                // На ПК\n                mainContainer.style.width = `calc(100vw - ${sidebarWidth}px)`;\n                mainContainer.style.left = `${sidebarWidth}px`;\n                mainContainer.style.maxWidth = `calc(100vw - ${sidebarWidth}px)`;\n            } else {\n                // На мобильных\n                mainContainer.style.width = '100vw';\n                mainContainer.style.left = '0';\n                mainContainer.style.maxWidth = '100vw';\n            }\n            \n            // Принудительное обновление размеров контейнера сообщений\n            messagesContainer.style.width = '100%';\n            messagesContainer.style.maxWidth = '100%';\n        }\n        \n        // Настройка обработчиков событий\n        function setupEventListeners() {\n            // Кнопка скрытия/показа sidebar (только для мобильных)\n            toggleSidebarBtn.addEventListener('click', toggleSidebar);\n            sidebarOverlay.addEventListener('click', toggleSidebarMobile);\n            \n            // Новый чат\n            newChatBtn.addEventListener('click', createNewChat);\n            \n            // Отправка сообщения\n            messageInput.addEventListener('input', autoResizeTextarea);\n            messageInput.addEventListener('keydown', handleKeydown);\n            sendButton.addEventListener('click', sendOrStopMessage);\n            \n            // Загрузка файлов\n            fileUpload.addEventListener('change', handleFileUpload);\n            \n            // Обработка изменения размера окна\n            window.addEventListener('resize', adjustLayout);\n            \n            // Прокрутка при загрузке\n            window.addEventListener('load', () => {\n                setTimeout(scrollToBottom, 100);\n                adjustLayout();\n            });\n        }\n        \n        // Показать индикатор \"ИИ думает\"\n        function showThinkingIndicator() {\n            if (thinkingIndicator) {\n                thinkingIndicator.remove();\n            }\n            \n            thinkingIndicator = document.createElement('div');\n            thinkingIndicator.className = 'thinking-indicator';\n            \n            thinkingIndicator.innerHTML = `\n                <div class=\"thinking-content\">\n                    <span>ИИ думает</span>\n                    <div class=\"thinking-dots\">\n                        <div class=\"thinking-dot\"></div>\n                        <div class=\"thinking-dot\"></div>\n                        <div class=\"thinking-dot\"></div>\n                    </div>\n                </div>\n            `;\n            \n            messagesContainer.appendChild(thinkingIndicator);\n            emptyChatMessage.style.display = 'none';\n            scrollToBottom();\n        }\n        \n        // Скрыть индикатор \"ИИ думает\"\n        function hideThinkingIndicator() {\n            if (thinkingIndicator) {\n                thinkingIndicator.remove();\n                thinkingIndicator = null;\n            }\n        }\n        \n        // Переключение sidebar на мобильных\n        function toggleSidebar() {\n            if (window.innerWidth <= 768) {\n                // На мобильных устройствах\n                sidebar.classList.toggle('active');\n                sidebarOverlay.classList.toggle('active');\n            }\n        }\n        \n        // Переключение sidebar на мобильных (через overlay)\n        function toggleSidebarMobile() {\n            if (window.innerWidth <= 768) {\n                sidebar.classList.remove('active');\n                sidebarOverlay.classList.remove('active');\n            }\n        }\n        \n        // Автоматическое изменение высоты textarea\n        function autoResizeTextarea() {\n            this.style.height = 'auto';\n            const newHeight = Math.min(this.scrollHeight, 200);\n            this.style.height = newHeight + 'px';\n            scrollToBottom();\n        }\n        \n        // Обработка нажатия клавиш\n        function handleKeydown(e) {\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                if (isTyping) {\n                    stopTyping();\n                } else {\n                    sendOrStopMessage();\n                }\n            }\n        }\n        \n        // Отправка сообщения или остановка печати\n        function sendOrStopMessage() {\n            if (isTyping) {\n                stopTyping();\n            } else {\n                sendMessage();\n            }\n        }\n        \n        // Проверка подключения к API\n        async function checkAPIConnection() {\n            updateStatus('Проверка подключения...', 'checking');\n            \n            try {\n                const response = await fetch('https://openrouter.ai/api/v1/models', {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': `Bearer ${API_KEY}`,\n                        'Content-Type': 'application/json'\n                    }\n                });\n                \n                if (response.ok) {\n                    updateStatus('Подключено', 'online');\n                } else {\n                    updateStatus('Не подключено', 'offline');\n                }\n            } catch (error) {\n                console.error('Ошибка проверки подключения:', error);\n                updateStatus('Не подключено', 'offline');\n            }\n        }\n        \n        // Обновление статуса\n        function updateStatus(text, statusType) {\n            statusText.textContent = text;\n            statusDot.className = 'status-dot ' + statusType;\n        }\n        \n        // Загрузка чатов из localStorage\n        function loadChatsFromStorage() {\n            const savedChats = localStorage.getItem('eloAiChats');\n            if (savedChats) {\n                chats = JSON.parse(savedChats);\n                \n                let maxId = 0;\n                for (const id in chats) {\n                    const chatId = parseInt(id);\n                    if (chatId > maxId) maxId = chatId;\n                }\n                chatCounter = maxId + 1;\n                \n                renderChatsList();\n                \n                const lastActiveChatId = localStorage.getItem('lastActiveChatId');\n                if (lastActiveChatId && chats[lastActiveChatId]) {\n                    loadChat(lastActiveChatId);\n                }\n            } else {\n                createNewChat();\n            }\n        }\n        \n        // Сохранение чатов в localStorage\n        function saveChatsToStorage() {\n            localStorage.setItem('eloAiChats', JSON.stringify(chats));\n            localStorage.setItem('lastActiveChatId', currentChatId);\n        }\n        \n        // Создание нового чата\n        function createNewChat() {\n            const chatId = chatCounter++;\n            const chatTitle = `Чат ${chatId}`;\n            const timestamp = new Date().toISOString();\n            \n            chats[chatId] = {\n                id: chatId,\n                title: chatTitle,\n                messages: [],\n                timestamp: timestamp,\n                lastModified: timestamp\n            };\n            \n            saveChatsToStorage();\n            renderChatsList();\n            loadChat(chatId);\n            \n            // Закрываем sidebar на мобильных\n            if (window.innerWidth <= 768) {\n                sidebar.classList.remove('active');\n                sidebarOverlay.classList.remove('active');\n            }\n            \n            return chatId;\n        }\n        \n        // Загрузка чата по ID\n        function loadChat(chatId) {\n            currentChatId = chatId;\n            const chat = chats[chatId];\n            \n            // Сохраняем ID активного чата\n            localStorage.setItem('lastActiveChatId', chatId);\n            \n            // Очищаем контейнер сообщений\n            messagesContainer.innerHTML = '';\n            \n            // Если в чате есть сообщения, показываем их\n            if (chat.messages.length > 0) {\n                emptyChatMessage.style.display = 'none';\n                \n                // Восстанавливаем все сообщения\n                chat.messages.forEach(msg => {\n                    if (msg.image) {\n                        addMessageWithImageToUI(msg.role, msg.content, msg.image, true);\n                    } else {\n                        addMessageToUI(msg.role, msg.content, false, true);\n                    }\n                });\n                \n                setTimeout(scrollToBottom, 100);\n            } else {\n                emptyChatMessage.style.display = 'flex';\n            }\n            \n            // Обновляем активный элемент в списке чатов\n            updateActiveChatInList(chatId);\n            \n            // Очищаем загруженные файлы\n            clearUploadedFiles();\n            \n            // Фокусируемся на поле ввода\n            messageInput.focus();\n            \n            // Сбрасываем состояние печати\n            resetTypingState();\n        }\n        \n        // Обновление активного чата в списке\n        function updateActiveChatInList(chatId) {\n            const chatItems = document.querySelectorAll('.chat-item');\n            chatItems.forEach(item => {\n                item.classList.remove('active');\n                if (item.dataset.chatId === chatId.toString()) {\n                    item.classList.add('active');\n                }\n            });\n        }\n        \n        // Отрисовка списка чатов\n        function renderChatsList() {\n            chatsList.innerHTML = '';\n            \n            const chatIds = Object.keys(chats);\n            \n            if (chatIds.length === 0) {\n                emptyChatsMessage.style.display = 'block';\n                return;\n            }\n            \n            emptyChatsMessage.style.display = 'none';\n            \n            const sortedChatIds = chatIds.sort((a, b) => {\n                return new Date(chats[b].lastModified) - new Date(chats[a].lastModified);\n            });\n            \n            sortedChatIds.forEach(chatId => {\n                const chat = chats[chatId];\n                const chatItem = document.createElement('div');\n                chatItem.className = `chat-item ${currentChatId == chatId ? 'active' : ''}`;\n                chatItem.dataset.chatId = chatId;\n                \n                chatItem.innerHTML = `\n                    <div class=\"chat-item-content\">\n                        <div class=\"chat-title\">${escapeHtml(chat.title)}</div>\n                    </div>\n                    <div class=\"chat-actions\">\n                        <button class=\"chat-action-btn rename-btn\" title=\"Переименовать\">\n                            <i class=\"fas fa-edit\"></i>\n                        </button>\n                        <button class=\"chat-action-btn delete-btn\" title=\"Удалить\">\n                            <i class=\"fas fa-trash\"></i>\n                        </button>\n                    </div>\n                `;\n                \n                chatItem.addEventListener('click', (e) => {\n                    if (!e.target.closest('.chat-actions')) {\n                        loadChat(chatId);\n                        \n                        if (window.innerWidth <= 768) {\n                            sidebar.classList.remove('active');\n                            sidebarOverlay.classList.remove('active');\n                        }\n                    }\n                });\n                \n                const renameBtn = chatItem.querySelector('.rename-btn');\n                const deleteBtn = chatItem.querySelector('.delete-btn');\n                \n                renameBtn.addEventListener('click', (e) => {\n                    e.stopPropagation();\n                    renameChat(chatId);\n                });\n                \n                deleteBtn.addEventListener('click', (e) => {\n                    e.stopPropagation();\n                    deleteChat(chatId);\n                });\n                \n                chatsList.appendChild(chatItem);\n            });\n            \n            chatsList.scrollTop = 0;\n        }\n        \n        // Переименование чата\n        function renameChat(chatId) {\n            const chat = chats[chatId];\n            const newTitle = prompt('Введите новое название для чата:', chat.title);\n            \n            if (newTitle && newTitle.trim() !== '') {\n                chat.title = newTitle.trim();\n                chat.lastModified = new Date().toISOString();\n                saveChatsToStorage();\n                renderChatsList();\n            }\n        }\n        \n        // Удаление чата\n        function deleteChat(chatId) {\n            if (!confirm('Вы уверены, что хотите удалить этот чат?')) return;\n            \n            delete chats[chatId];\n            saveChatsToStorage();\n            \n            if (currentChatId == chatId) {\n                const remainingChats = Object.keys(chats);\n                \n                if (remainingChats.length > 0) {\n                    loadChat(remainingChats[0]);\n                } else {\n                    createNewChat();\n                }\n            }\n            \n            renderChatsList();\n        }\n        \n        // Обработка загрузки файлов\n        function handleFileUpload(event) {\n            const files = event.target.files;\n            \n            for (let i = 0; i < files.length; i++) {\n                const file = files[i];\n                \n                if (!file.type.match('image.*')) {\n                    showError('Можно загружать только изображения');\n                    continue;\n                }\n                \n                if (file.size > 5 * 1024 * 1024) {\n                    showError('Файл слишком большой. Максимальный размер: 5MB');\n                    continue;\n                }\n                \n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    const fileData = {\n                        id: Date.now() + i,\n                        name: file.name,\n                        type: file.type,\n                        size: file.size,\n                        data: e.target.result\n                    };\n                    \n                    uploadedFiles.push(fileData);\n                    renderUploadedFiles();\n                };\n                reader.readAsDataURL(file);\n            }\n            \n            event.target.value = '';\n        }\n        \n        // Отрисовка загруженных файлов\n        function renderUploadedFiles() {\n            uploadedFilesContainer.innerHTML = '';\n            \n            uploadedFiles.forEach(file => {\n                const fileElement = document.createElement('div');\n                fileElement.className = 'uploaded-file';\n                fileElement.dataset.fileId = file.id;\n                \n                fileElement.innerHTML = `\n                    <i class=\"fas fa-image file-icon\"></i>\n                    <span class=\"file-name\" title=\"${escapeHtml(file.name)}\">${escapeHtml(file.name)}</span>\n                    <button class=\"file-remove\" data-file-id=\"${file.id}\">\n                        <i class=\"fas fa-times\"></i>\n                    </button>\n                `;\n                \n                uploadedFilesContainer.appendChild(fileElement);\n            });\n            \n            document.querySelectorAll('.file-remove').forEach(btn => {\n                btn.addEventListener('click', function() {\n                    const fileId = parseInt(this.dataset.fileId);\n                    removeUploadedFile(fileId);\n                });\n            });\n        }\n        \n        // Удаление загруженного файла\n        function removeUploadedFile(fileId) {\n            uploadedFiles = uploadedFiles.filter(file => file.id !== fileId);\n            renderUploadedFiles();\n        }\n        \n        // Очистка всех загруженных файлов\n        function clearUploadedFiles() {\n            uploadedFiles = [];\n            renderUploadedFiles();\n        }\n        \n        // Прокрутка к нижней части чата\n        function scrollToBottom() {\n            setTimeout(() => {\n                messagesContainer.scrollTop = messagesContainer.scrollHeight;\n            }, 50);\n        }\n        \n        // Анимация печати текста по буквам\n        function startTyping(element, text, speed = 20) {\n            isTyping = true;\n            currentTypingElement = element;\n            fullText = text;\n            typingIndex = 0;\n            typingSpeed = speed;\n            \n            // Скрываем индикатор \"ИИ думает\"\n            hideThinkingIndicator();\n            \n            // Меняем кнопку на \"стоп\"\n            sendButton.classList.add('stop-typing');\n            sendIcon.className = 'fas fa-stop';\n            sendButton.title = 'Остановить печать';\n            \n            // Разрешаем прокрутку во время печати\n            messagesContainer.classList.add('typing-active');\n            \n            element.innerHTML = '';\n            \n            function typeChar() {\n                if (!isTyping) {\n                    // Завершаем печать\n                    element.classList.remove('typing-text');\n                    element.style.borderRight = 'none';\n                    processMessageContent(element.parentElement.parentElement);\n                    return;\n                }\n                \n                if (typingIndex < fullText.length) {\n                    const char = fullText.charAt(typingIndex);\n                    element.innerHTML += escapeHtml(char);\n                    \n                    typingIndex++;\n                    \n                    // Автоматическая прокрутка во время печати\n                    if (typingIndex % 10 === 0 || typingIndex === fullText.length) {\n                        scrollToBottom();\n                    }\n                    \n                    typingTimeout = setTimeout(typeChar, typingSpeed);\n                } else {\n                    // Завершаем печать\n                    isTyping = false;\n                    element.classList.remove('typing-text');\n                    element.style.borderRight = 'none';\n                    processMessageContent(element.parentElement.parentElement);\n                    \n                    // Возвращаем кнопку в исходное состояние\n                    resetSendButton();\n                    \n                    // Убираем класс разрешения прокрутки\n                    messagesContainer.classList.remove('typing-active');\n                }\n            }\n            \n            typeChar();\n        }\n        \n        // Остановка печати\n        function stopTyping() {\n            if (!isTyping) return;\n            \n            isTyping = false;\n            clearTimeout(typingTimeout);\n            \n            // Скрываем индикатор \"ИИ думает\"\n            hideThinkingIndicator();\n            \n            if (currentTypingElement) {\n                currentTypingElement.classList.remove('typing-text');\n                currentTypingElement.style.borderRight = 'none';\n                \n                // Показываем весь текст\n                if (typingIndex < fullText.length) {\n                    currentTypingElement.innerHTML = escapeHtml(fullText);\n                    processMessageContent(currentTypingElement.parentElement.parentElement);\n                }\n            }\n            \n            // Возвращаем кнопку в исходное состояние\n            resetSendButton();\n            \n            // Убираем класс разрешения прокрутки\n            messagesContainer.classList.remove('typing-active');\n            \n            // Фокусируемся на поле ввода\n            messageInput.focus();\n        }\n        \n        // Сброс состояния печати\n        function resetTypingState() {\n            isTyping = false;\n            clearTimeout(typingTimeout);\n            currentTypingElement = null;\n            typingIndex = 0;\n            fullText = '';\n            hideThinkingIndicator();\n            resetSendButton();\n            messagesContainer.classList.remove('typing-active');\n        }\n        \n        // Сброс кнопки отправки\n        function resetSendButton() {\n            sendButton.classList.remove('stop-typing');\n            sendIcon.className = 'fas fa-arrow-up';\n            sendButton.title = 'Отправить сообщение';\n        }\n        \n        // Обработка содержимого сообщения (код и кнопки копирования)\n        function processMessageContent(messageElement) {\n            const messageContent = messageElement.querySelector('.message-content');\n            if (!messageContent) return;\n            \n            // Добавляем кнопку копирования сообщения\n            addCopyMessageButton(messageContent);\n            \n            // Обработка блоков кода\n            const messageText = messageContent.querySelector('.message-text');\n            if (messageText) {\n                processCodeBlocks(messageText);\n            }\n        }\n        \n        // Добавление кнопки копирования сообщения\n        function addCopyMessageButton(messageContent) {\n            // Удаляем старую кнопку если есть\n            const oldBtn = messageContent.querySelector('.copy-message-btn');\n            if (oldBtn) oldBtn.remove();\n            \n            // Получаем текст сообщения\n            const messageText = messageContent.querySelector('.message-text');\n            if (!messageText) return;\n            \n            const textToCopy = getMessageTextContent(messageText);\n            \n            // Создаем новую кнопку\n            const copyBtn = document.createElement('button');\n            copyBtn.className = 'copy-message-btn';\n            copyBtn.title = 'Копировать сообщение';\n            copyBtn.innerHTML = '<i class=\"far fa-copy\"></i>';\n            copyBtn.setAttribute('data-text', textToCopy);\n            \n            copyBtn.addEventListener('click', function(e) {\n                e.stopPropagation();\n                copyMessageText(this.getAttribute('data-text'), this);\n            });\n            \n            messageContent.appendChild(copyBtn);\n        }\n        \n        // Получение текстового содержимого сообщения\n        function getMessageTextContent(messageTextElement) {\n            // Клонируем элемент чтобы не повредить оригинал\n            const clone = messageTextElement.cloneNode(true);\n            \n            // Убираем кнопки копирования кода\n            clone.querySelectorAll('.copy-code-btn').forEach(btn => btn.remove());\n            \n            // Конвертируем HTML в текст\n            return clone.innerText || clone.textContent;\n        }\n        \n        // Копирование текста сообщения\n        function copyMessageText(text, button) {\n            navigator.clipboard.writeText(text).then(() => {\n                const originalHTML = button.innerHTML;\n                button.innerHTML = '<i class=\"fas fa-check\"></i>';\n                button.style.color = '#22c55e';\n                \n                setTimeout(() => {\n                    button.innerHTML = originalHTML;\n                    button.style.color = '';\n                }, 2000);\n            }).catch(err => {\n                console.error('Ошибка копирования:', err);\n                button.innerHTML = '<i class=\"fas fa-times\"></i>';\n                button.style.color = '#ef4444';\n                \n                setTimeout(() => {\n                    button.innerHTML = '<i class=\"far fa-copy\"></i>';\n                    button.style.color = '';\n                }, 2000);\n            });\n        }\n        \n        // Обработка блоков кода в сообщении\n        function processCodeBlocks(messageText) {\n            const content = messageText.innerHTML;\n            \n            // Регулярное выражение для блоков кода с языком и без\n            const codeBlockRegex = /```(\\w+)?\\s*\\n?([\\s\\S]*?)```/g;\n            let processedContent = content;\n            let match;\n            let lastIndex = 0;\n            let result = '';\n            \n            while ((match = codeBlockRegex.exec(content)) !== null) {\n                // Добавляем текст до блока кода\n                result += content.substring(lastIndex, match.index);\n                \n                const language = match[1] || 'text';\n                const code = match[2].trim();\n                const codeId = 'code_' + Date.now() + Math.random().toString(36).substr(2, 9);\n                \n                result += `\n                    <div class=\"code-block\" id=\"${codeId}\">\n                        <div class=\"code-header\">\n                            <span class=\"code-language\">${language}</span>\n                            <button class=\"copy-code-btn\" onclick=\"copyCode('${codeId}')\" data-code=\"${escapeHtml(code)}\">\n                                <i class=\"far fa-copy\"></i> Копировать\n                            </button>\n                        </div>\n                        <div class=\"code-content\">\n                            <pre><code>${escapeHtml(code)}</code></pre>\n                        </div>\n                    </div>\n                `;\n                \n                lastIndex = match.index + match[0].length;\n            }\n            \n            // Добавляем оставшийся текст после последнего блока кода\n            result += content.substring(lastIndex);\n            \n            messageText.innerHTML = result;\n            \n            // Обработка инлайн кода\n            messageText.innerHTML = messageText.innerHTML.replace(/`([^`\\n]+?)`/g, '<code>$1</code>');\n            \n            // Подсветка синтаксиса\n            highlightCodeBlocks(messageText.parentElement.parentElement);\n        }\n        \n        // Функция для копирования кода\n        window.copyCode = function(codeId) {\n            const codeBlock = document.getElementById(codeId);\n            if (!codeBlock) return;\n            \n            const copyBtn = codeBlock.querySelector('.copy-code-btn');\n            const codeContent = copyBtn.getAttribute('data-code');\n            \n            navigator.clipboard.writeText(codeContent).then(() => {\n                const originalText = copyBtn.innerHTML;\n                copyBtn.innerHTML = '<i class=\"fas fa-check\"></i> Скопировано!';\n                copyBtn.classList.add('copied');\n                \n                setTimeout(() => {\n                    copyBtn.innerHTML = originalText;\n                    copyBtn.classList.remove('copied');\n                }, 2000);\n            }).catch(err => {\n                console.error('Ошибка копирования:', err);\n                copyBtn.innerHTML = '<i class=\"fas fa-times\"></i> Ошибка';\n                \n                setTimeout(() => {\n                    copyBtn.innerHTML = '<i class=\"far fa-copy\"></i> Копировать';\n                }, 2000);\n            });\n        };\n        \n        // Отправка сообщения\n        async function sendMessage() {\n            const messageText = messageInput.value.trim();\n            \n            if (!messageText && uploadedFiles.length === 0) return;\n            \n            if (!currentChatId) {\n                currentChatId = createNewChat();\n            }\n            \n            const chat = chats[currentChatId];\n            \n            const messageData = {\n                role: \"user\",\n                content: messageText || (uploadedFiles.length > 0 ? \"Прикреплено изображение\" : \"\"),\n                timestamp: new Date().toISOString()\n            };\n            \n            if (uploadedFiles.length > 0) {\n                messageData.image = uploadedFiles[0].data;\n            }\n            \n            if (messageData.image) {\n                addMessageWithImageToUI('user', messageText || \"\", messageData.image, true);\n            } else {\n                addMessageToUI('user', messageText, true);\n            }\n            \n            chat.messages.push(messageData);\n            chat.lastModified = new Date().toISOString();\n            saveChatsToStorage();\n            \n            messageInput.value = '';\n            messageInput.style.height = 'auto';\n            clearUploadedFiles();\n            \n            renderChatsList();\n            \n            sendButton.disabled = true;\n            \n            // Показываем индикатор \"ИИ думает\"\n            showThinkingIndicator();\n            \n            try {\n                const apiMessages = chat.messages.map(msg => ({\n                    role: msg.role,\n                    content: msg.image ? `${msg.content} [Изображение прикреплено]` : msg.content\n                }));\n                \n                const response = await fetch(API_URL, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${API_KEY}`,\n                        'HTTP-Referer': window.location.origin || 'https://localhost',\n                        'X-Title': 'eloAi Chat'\n                    },\n                    body: JSON.stringify({\n                        model: \"google/gemma-3-4b-it\",\n                        messages: apiMessages,\n                        max_tokens: 2048,\n                        temperature: 0.7\n                    })\n                });\n                \n                if (!response.ok) {\n                    const errorData = await response.json().catch(() => ({}));\n                    throw new Error(`Ошибка API (${response.status}): ${errorData.error?.message || response.statusText}`);\n                }\n                \n                const data = await response.json();\n                const aiMessage = data.choices[0].message.content;\n                \n                const messageElement = document.createElement('div');\n                messageElement.className = 'message assistant';\n                \n                messageElement.innerHTML = `\n                    <div class=\"message-content\">\n                        <div class=\"message-text typing-text\" id=\"typingText_${Date.now()}\"></div>\n                    </div>\n                `;\n                \n                messagesContainer.appendChild(messageElement);\n                emptyChatMessage.style.display = 'none';\n                \n                const textElement = messageElement.querySelector('.message-text');\n                \n                scrollToBottom();\n                \n                // Запускаем анимацию печати\n                startTyping(textElement, aiMessage);\n                \n                // Добавляем сообщение в историю (полный текст)\n                chat.messages.push({ \n                    role: \"assistant\", \n                    content: aiMessage,\n                    timestamp: new Date().toISOString()\n                });\n                \n                chat.lastModified = new Date().toISOString();\n                saveChatsToStorage();\n                renderChatsList();\n                updateStatus('Подключено', 'online');\n                \n            } catch (error) {\n                console.error('Ошибка при отправке сообщения:', error);\n                \n                // Скрываем индикатор \"ИИ думает\" при ошибке\n                hideThinkingIndicator();\n                \n                const errorElement = document.createElement('div');\n                errorElement.className = 'error-message';\n                errorElement.innerHTML = `<strong>Ошибка:</strong> ${escapeHtml(error.message)}. Попробуйте еще раз.`;\n                messagesContainer.appendChild(errorElement);\n                \n                updateStatus('Не подключено', 'offline');\n                \n            } finally {\n                sendButton.disabled = false;\n                messageInput.focus();\n                scrollToBottom();\n            }\n        }\n        \n        // Функция экранирования HTML\n        function escapeHtml(text) {\n            if (!text) return '';\n            const div = document.createElement('div');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n        \n        // Функция добавления сообщения в UI\n        function addMessageToUI(role, content, isUserMessage = false, isRestoring = false) {\n            emptyChatMessage.style.display = 'none';\n            \n            const messageElement = document.createElement('div');\n            messageElement.className = `message ${role}`;\n            \n            messageElement.innerHTML = `\n                <div class=\"message-content\">\n                    <div class=\"message-text\">${formatMessageText(content, isUserMessage)}</div>\n                </div>\n            `;\n            \n            messagesContainer.appendChild(messageElement);\n            \n            // Обработка сообщения\n            processMessageContent(messageElement);\n            \n            if (!isRestoring) {\n                scrollToBottom();\n            }\n        }\n        \n        // Функция форматирования текста сообщения\n        function formatMessageText(text, isUserMessage = false) {\n            if (!text) return '';\n            \n            let safeText = escapeHtml(text);\n            safeText = safeText.replace(/\\n/g, '<br>');\n            \n            // Обрабатываем блоки кода (обрабатываются отдельно)\n            safeText = safeText.replace(/```[\\s\\S]*?```/g, '');\n            \n            // Обрабатываем инлайн-код\n            safeText = safeText.replace(/`([^`\\n]+?)`/g, '<code>$1</code>');\n            \n            safeText = safeText.replace(/  /g, ' &nbsp;');\n            \n            return safeText;\n        }\n        \n        // Функция добавления сообщения с изображением\n        function addMessageWithImageToUI(role, content, imageData, isRestoring = false) {\n            emptyChatMessage.style.display = 'none';\n            \n            const messageElement = document.createElement('div');\n            messageElement.className = `message ${role}`;\n            \n            messageElement.innerHTML = `\n                <div class=\"message-content\">\n                    ${content ? `<div class=\"message-text\">${formatMessageText(content)}</div>` : ''}\n                    <img src=\"${imageData}\" alt=\"Прикрепленное изображение\" class=\"image-preview\">\n                </div>\n            `;\n            \n            messagesContainer.appendChild(messageElement);\n            \n            // Обработка сообщения\n            processMessageContent(messageElement);\n            \n            if (!isRestoring) {\n                scrollToBottom();\n            }\n        }\n        \n        // Подсветка синтаксиса в блоках кода\n        function highlightCodeBlocks(element) {\n            const codeBlocks = element.querySelectorAll('.code-content code');\n            codeBlocks.forEach(block => {\n                let code = block.textContent;\n                \n                // Простая подсветка для HTML\n                if (code.includes('</') || code.includes('/>') || \n                    (code.includes('<') && code.includes('>'))) {\n                    \n                    code = code.replace(/&lt;(\\/?)(\\w+)([^&]*)&gt;/g, \n                        '<span style=\"color:#ff79c6\">&lt;$1</span><span style=\"color:#8be9fd\">$2</span><span style=\"color:#f8f8f2\">$3</span><span style=\"color:#ff79c6\">&gt;</span>');\n                }\n                // Простая подсветка для JavaScript\n                else if (code.includes('function') || code.includes('const ') || \n                         code.includes('let ') || code.includes('var ')) {\n                    \n                    code = code.replace(/(function|const|let|var|return|if|else|for|while|class|import|export|from|default)\\b/g, \n                        '<span style=\"color:#ff79c6\">$1</span>');\n                    \n                    code = code.replace(/(\"([^\"\\\\]|\\\\.)*\"|'([^'\\\\]|\\\\.)*')/g, \n                        '<span style=\"color:#f1fa8c\">$1</span>');\n                }\n                // Простая подсветка для CSS\n                else if (code.includes('{') || code.includes('}') || \n                         code.includes('color:') || code.includes('padding:')) {\n                    \n                    code = code.replace(/(\\.|#)?([\\w-]+)\\s*\\{/g, \n                        '<span style=\"color:#8be9fd\">$1$2</span><span style=\"color:#f8f8f2\"> {</span>');\n                    \n                    code = code.replace(/([\\w-]+)\\s*:/g, \n                        '<span style=\"color:#50fa7b\">$1</span><span style=\"color:#f8f8f2\">:</span>');\n                }\n                \n                block.innerHTML = code;\n            });\n        }\n        \n        // Показать ошибку\n        function showError(message) {\n            const errorElement = document.createElement('div');\n            errorElement.className = 'error-message';\n            errorElement.textContent = message;\n            \n            const inputContainer = document.querySelector('.input-container');\n            inputContainer.insertBefore(errorElement, inputContainer.firstChild);\n            \n            setTimeout(() => {\n                errorElement.remove();\n            }, 5000);\n        }\n        \n        // Фокусировка на поле ввода\n        window.addEventListener('load', () => {\n            messageInput.focus();\n        });\n    </script>\n</body>\n</html>",true,"","fullscreen; autoplay; encrypted-media",false,"allow-scripts"],""]],[],0,true,false,false,[]]],[],[]]],[["Loading_System",[[0,0,false,null,429616592987880,1,[[-1,5,null,1,false,false,false,815234581656522,null]],[[2,6,null,220495524678319,0,null,[[0,[0,[4,7]]]]],[2,8,null,392950303402847,0,null,[[0,[0,[4,9]]]]]]],[0,0,false,null,842255195047728,2,[[-1,10,null,1,false,false,false,110039588726685,null]],[[-1,11,null,301252973496445,4096,null,[[0,[1]],[16,true]]],[-1,12,null,972329311103472,0,null,[[6,"Home"]]]]]]],["Home_System",[]]],[],"media/",true,1080,1920,3,false,"trilinear",false,"1.0",false,true,3,0,5,false,true,1,true,0.7853981633974483,[],"icons/",[],"normalized","nsd6s1tucdc","fonts/",[["Шкала 1",5,0.1,"default","default",[],0,0,1,"",1,1]],"high-performance",[],1764711164495,"vsync","com.GeoCade.eloAi","icons/Иконка-загрузки.png",false,4,false,null,[],"folders",1,10000,false,[["Блок-схема 1",[]]],"auto"]}